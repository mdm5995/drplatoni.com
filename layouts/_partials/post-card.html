{{/* Expects: The context of a single page (the "dot")
Usage: {{ partial "post-card.html" . }}
*/}}

{{/* get or default for thumbnail */}}
{{ $image := resources.Get "images/default-thumbnail.jpg" }}
{{ with .Resources.GetMatch "featured-image*" }}
{{ $image = . }}
{{ end }}

<article class="stack post-card">
	<a class="stack" href="{{ .RelPermalink }}">
		{{ with $image }}
		{{ $thumbnail := .Resize "500x webp q80" }}
		<img src="{{ $thumbnail.RelPermalink }}" width={{ $thumbnail.Width }} height="{{ $thumbnail.Height }}" alt="{{ $.Title }}" loading="lazy">
		{{ end }}
		<header>
			<h3>{{ .Title }}</h3>
		</header>
	</a>
	<p>{{ .Summary | plainify | truncate 200 }}</p>
	<a class="button basic" href="{{ .RelPermalink }}">
		Read More
	</a>
</article>
